{"ast":null,"code":"import React from \"react\";\nimport { useQuery } from \"@apollo/client\";\nimport gql from \"graphql-tag\";\n\nconst getOrders = user => {\n  const {\n    ordersPoll,\n    fetchMore,\n    loading\n  } = getOrdersOfUser(user);\n  return {\n    loading,\n    ordersPoll,\n    fetchMore\n  };\n}; // TODO: Add the GraphQL query for fetching all deliveries.\n\n\nconst GetOrdersOfUserQuery = gql`\n  query AllOrders($user: ObjectId!, $limit: Int) {\n    orders(query: { user: $user }, limit: $limit, sortBy: _ID_DESC) {\n      _id\n      orderNo\n      saleDate\n      customer {\n        _id\n        name\n      }\n    }\n  }\n`;\n\nfunction getOrdersOfUser(user) {\n  var _data$orders;\n\n  const queryResult = useQuery(GetOrdersOfUserQuery, {\n    variables: {\n      user: user._id,\n      offset: 0,\n      limit: 10000\n    }\n  }, {});\n  const {\n    data,\n    loading,\n    fetchMore,\n    error,\n    startPolling,\n    stopPolling\n  } = queryResult;\n  React.useEffect(() => {\n    // check server for updates every 1000ms\n    startPolling(1000); // stop polling server for data when component unmounts\n    // return () => stopPolling();\n  }, [startPolling, stopPolling]);\n\n  if (error) {\n    throw new Error(JSON.stringify(error, null, 2));\n  } // If the query has finished, return the deliveries from the result data\n  // Otherwise, return an empty list\n\n\n  const ordersPoll = (_data$orders = data === null || data === void 0 ? void 0 : data.orders) !== null && _data$orders !== void 0 ? _data$orders : [];\n  console.log(data);\n  return {\n    ordersPoll,\n    fetchMore,\n    loading\n  };\n}\n\nexport default getOrders;","map":{"version":3,"sources":["/Users/pulkitshah/Desktop/truckarv2/renderer/graphql/orders.js"],"names":["React","useQuery","gql","getOrders","user","ordersPoll","fetchMore","loading","getOrdersOfUser","GetOrdersOfUserQuery","queryResult","variables","_id","offset","limit","data","error","startPolling","stopPolling","useEffect","Error","JSON","stringify","orders","console","log"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,gBAAzB;AACA,OAAOC,GAAP,MAAgB,aAAhB;;AAEA,MAAMC,SAAS,GAAIC,IAAD,IAAU;AAC1B,QAAM;AAAEC,IAAAA,UAAF;AAAcC,IAAAA,SAAd;AAAyBC,IAAAA;AAAzB,MACJC,eAAe,CAACJ,IAAD,CADjB;AAEA,SAAO;AACLG,IAAAA,OADK;AAELF,IAAAA,UAFK;AAGLC,IAAAA;AAHK,GAAP;AAKD,CARD,C,CAUA;;;AAEA,MAAMG,oBAAoB,GAAGP,GAAI;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAZA;;AAcA,SAASM,eAAT,CAAyBJ,IAAzB,EAA+B;AAAA;;AAC7B,QAAMM,WAAW,GAAGT,QAAQ,CAC1BQ,oBAD0B,EAE1B;AACEE,IAAAA,SAAS,EAAE;AACTP,MAAAA,IAAI,EAAEA,IAAI,CAACQ,GADF;AAETC,MAAAA,MAAM,EAAE,CAFC;AAGTC,MAAAA,KAAK,EAAE;AAHE;AADb,GAF0B,EAS1B,EAT0B,CAA5B;AAWA,QAAM;AAAEC,IAAAA,IAAF;AAAQR,IAAAA,OAAR;AAAiBD,IAAAA,SAAjB;AAA4BU,IAAAA,KAA5B;AAAmCC,IAAAA,YAAnC;AAAiDC,IAAAA;AAAjD,MACJR,WADF;AAGAV,EAAAA,KAAK,CAACmB,SAAN,CAAgB,MAAM;AACpB;AACAF,IAAAA,YAAY,CAAC,IAAD,CAAZ,CAFoB,CAGpB;AACA;AACD,GALD,EAKG,CAACA,YAAD,EAAeC,WAAf,CALH;;AAOA,MAAIF,KAAJ,EAAW;AACT,UAAM,IAAII,KAAJ,CAAUC,IAAI,CAACC,SAAL,CAAeN,KAAf,EAAsB,IAAtB,EAA4B,CAA5B,CAAV,CAAN;AACD,GAxB4B,CAyB7B;AACA;;;AACA,QAAMX,UAAU,mBAAGU,IAAH,aAAGA,IAAH,uBAAGA,IAAI,CAAEQ,MAAT,uDAAmB,EAAnC;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYV,IAAZ;AAEA,SAAO;AACLV,IAAAA,UADK;AAELC,IAAAA,SAFK;AAGLC,IAAAA;AAHK,GAAP;AAKD;;AASD,eAAeJ,SAAf","sourcesContent":["import React from \"react\";\nimport { useQuery } from \"@apollo/client\";\nimport gql from \"graphql-tag\";\n\nconst getOrders = (user) => {\n  const { ordersPoll, fetchMore, loading } =\n    getOrdersOfUser(user);\n  return {\n    loading,\n    ordersPoll,\n    fetchMore,\n  };\n};\n\n// TODO: Add the GraphQL query for fetching all deliveries.\n\nconst GetOrdersOfUserQuery = gql`\n  query AllOrders($user: ObjectId!, $limit: Int) {\n    orders(query: { user: $user }, limit: $limit, sortBy: _ID_DESC) {\n      _id\n      orderNo\n      saleDate\n      customer {\n        _id\n        name\n      }\n    }\n  }\n`;\n\nfunction getOrdersOfUser(user) {\n  const queryResult = useQuery(\n    GetOrdersOfUserQuery,\n    {\n      variables: {\n        user: user._id,\n        offset: 0,\n        limit: 10000,\n      },\n    },\n    {}\n  );\n  const { data, loading, fetchMore, error, startPolling, stopPolling } =\n    queryResult;\n\n  React.useEffect(() => {\n    // check server for updates every 1000ms\n    startPolling(1000);\n    // stop polling server for data when component unmounts\n    // return () => stopPolling();\n  }, [startPolling, stopPolling]);\n\n  if (error) {\n    throw new Error(JSON.stringify(error, null, 2));\n  }\n  // If the query has finished, return the deliveries from the result data\n  // Otherwise, return an empty list\n  const ordersPoll = data?.orders ?? [];\n  console.log(data)\n\n  return {\n    ordersPoll,\n    fetchMore,\n    loading,\n  };\n}\n\n\n\n\n\n\n\n\nexport default getOrders;\n"]},"metadata":{},"sourceType":"module"}