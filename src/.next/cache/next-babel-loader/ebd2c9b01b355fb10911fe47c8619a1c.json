{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { API } from \"aws-amplify\";\nimport { addressesByParty, addressesByUser } from \"../graphql/queries\";\nimport { createAddress, updateAddress } from \"../graphql/mutations\";\nimport { Address } from \"../models\";\nimport { DataStore } from \"@aws-amplify/datastore\";\nimport moment from \"moment\";\nimport { slice } from \"../slices/addresses\";\nconst now = new Date();\n\nclass AddressApi {\n  async getAddressesByUser(user, dispatch) {\n    try {\n      //////////////////////// GraphQL API ////////////////////////\n      // const response = await API.graphql({\n      //   query: addressesByUser,\n      //   variables: { user: user.id.toString() },\n      // });\n      // const addresses = response.data.addressesByUser.items;\n      //////////////////////// GraphQL API ////////////////////////\n      //////////////////////// DataStore API ////////////////////////\n      const addresses = await DataStore.query(Address, c => c.user(\"eq\", user.id)); //////////////////////// DataStore API ////////////////////////\n\n      console.log(addresses); // Dispatch - Reducer\n\n      dispatch(slice.actions.getAddresses(addresses));\n      return addresses;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  async getAddressesByParty(party, dispatch) {\n    try {\n      //////////////////////// GraphQL API ////////////////////////\n      console.log(party.id.toString());\n      const response = await API.graphql({\n        query: addressesByParty,\n        variables: {\n          partyId: party.id.toString()\n        }\n      });\n      const addresses = response.data.addressesByParty.items; //////////////////////// GraphQL API ////////////////////////\n      //////////////////////// DataStore API ////////////////////////\n      // const addresses = await DataStore.query(Address, (c) =>\n      //   c.user(\"eq\", user.id)\n      // );\n      //////////////////////// DataStore API ////////////////////////\n\n      console.log(addresses); // Dispatch - Reducer\n\n      dispatch(slice.actions.getAddresses(addresses));\n      return addresses;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  async createAddress(createdAddress, dispatch) {\n    const createdAt = moment().toISOString();\n\n    let newAddress = _objectSpread({}, createdAddress);\n\n    newAddress.createdAt = createdAt;\n    console.log(newAddress); //////////////////////// GraphQL API ////////////////////////\n    // const response = await API.graphql({\n    //   query: createAddress,\n    //   variables: { input: newAddress },\n    //   authMode: \"AMAZON_COGNITO_USER_POOLS\",\n    // });\n    // const address = response.data.createAddress;\n    //////////////////////// GraphQL API ////////////////////////\n    //////////////////////// DataStore API ////////////////////////\n\n    const address = await DataStore.save(new Address(newAddress)); //////////////////////// DataStore API ////////////////////////\n    // console.log(address);\n    // Dispatch - Reducer\n\n    dispatch(slice.actions.createAddress({\n      address\n    }));\n    return address;\n  }\n\n  async updateAddress(editedAddress, dispatch) {\n    //////////////////////// GraphQL API ////////////////////////\n    const response = await API.graphql({\n      query: updateAddress,\n      variables: {\n        input: editedAddress\n      },\n      authMode: \"AMAZON_COGNITO_USER_POOLS\"\n    });\n    const address = response.data.updateAddress; //////////////////////// GraphQL API ////////////////////////\n    // console.log(address);\n    // Dispatch - Reducer\n\n    dispatch(slice.actions.updateAddress({\n      address\n    }));\n    return response;\n  }\n\n  async subscribeForNewAddresses(party, addresses, dispatch) {\n    DataStore.observe(Address).subscribe(add => {\n      const address = addresses.find(address => {\n        return address.id === add.element.id;\n      });\n\n      if (add.opType === \"INSERT\") {\n        if (!address) {\n          console.log(add); // dispatch(slice.actions.createAddress({ address }));\n        }\n      }\n    });\n  }\n\n}\n\nexport const addressApi = new AddressApi();","map":{"version":3,"sources":["/Users/pulkitshah/Desktop/truckarv2/renderer/api/address-api.js"],"names":["API","addressesByParty","addressesByUser","createAddress","updateAddress","Address","DataStore","moment","slice","now","Date","AddressApi","getAddressesByUser","user","dispatch","addresses","query","c","id","console","log","actions","getAddresses","error","getAddressesByParty","party","toString","response","graphql","variables","partyId","data","items","createdAddress","createdAt","toISOString","newAddress","address","save","editedAddress","input","authMode","subscribeForNewAddresses","observe","subscribe","add","find","element","opType","addressApi"],"mappings":"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","sourcesContent":["import { API } from \"aws-amplify\";\nimport { addressesByParty, addressesByUser } from \"../graphql/queries\";\nimport { createAddress, updateAddress } from \"../graphql/mutations\";\nimport { Address } from \"../models\";\nimport { DataStore } from \"@aws-amplify/datastore\";\nimport moment from \"moment\";\nimport { slice } from \"../slices/addresses\";\n\nconst now = new Date();\n\nclass AddressApi {\n  async getAddressesByUser(user, dispatch) {\n    try {\n      //////////////////////// GraphQL API ////////////////////////\n\n      // const response = await API.graphql({\n      //   query: addressesByUser,\n      //   variables: { user: user.id.toString() },\n      // });\n      // const addresses = response.data.addressesByUser.items;\n\n      //////////////////////// GraphQL API ////////////////////////\n\n      //////////////////////// DataStore API ////////////////////////\n\n      const addresses = await DataStore.query(Address, (c) =>\n        c.user(\"eq\", user.id)\n      );\n\n      //////////////////////// DataStore API ////////////////////////\n\n      console.log(addresses);\n\n      // Dispatch - Reducer\n\n      dispatch(slice.actions.getAddresses(addresses));\n\n      return addresses;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  async getAddressesByParty(party, dispatch) {\n    try {\n      //////////////////////// GraphQL API ////////////////////////\n      console.log(party.id.toString());\n      const response = await API.graphql({\n        query: addressesByParty,\n        variables: { partyId: party.id.toString() },\n      });\n      const addresses = response.data.addressesByParty.items;\n\n      //////////////////////// GraphQL API ////////////////////////\n\n      //////////////////////// DataStore API ////////////////////////\n\n      // const addresses = await DataStore.query(Address, (c) =>\n      //   c.user(\"eq\", user.id)\n      // );\n\n      //////////////////////// DataStore API ////////////////////////\n\n      console.log(addresses);\n\n      // Dispatch - Reducer\n\n      dispatch(slice.actions.getAddresses(addresses));\n\n      return addresses;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  async createAddress(createdAddress, dispatch) {\n    const createdAt = moment().toISOString();\n    let newAddress = { ...createdAddress };\n    newAddress.createdAt = createdAt;\n\n    console.log(newAddress);\n\n    //////////////////////// GraphQL API ////////////////////////\n\n    // const response = await API.graphql({\n    //   query: createAddress,\n    //   variables: { input: newAddress },\n    //   authMode: \"AMAZON_COGNITO_USER_POOLS\",\n    // });\n\n    // const address = response.data.createAddress;\n\n    //////////////////////// GraphQL API ////////////////////////\n\n    //////////////////////// DataStore API ////////////////////////\n\n    const address = await DataStore.save(new Address(newAddress));\n\n    //////////////////////// DataStore API ////////////////////////\n\n    // console.log(address);\n\n    // Dispatch - Reducer\n\n    dispatch(slice.actions.createAddress({ address }));\n\n    return address;\n  }\n\n  async updateAddress(editedAddress, dispatch) {\n    //////////////////////// GraphQL API ////////////////////////\n\n    const response = await API.graphql({\n      query: updateAddress,\n      variables: { input: editedAddress },\n      authMode: \"AMAZON_COGNITO_USER_POOLS\",\n    });\n\n    const address = response.data.updateAddress;\n\n    //////////////////////// GraphQL API ////////////////////////\n\n    // console.log(address);\n\n    // Dispatch - Reducer\n\n    dispatch(slice.actions.updateAddress({ address }));\n\n    return response;\n  }\n\n  async subscribeForNewAddresses(party, addresses, dispatch) {\n    DataStore.observe(Address).subscribe((add) => {\n      const address = addresses.find((address) => {\n        return address.id === add.element.id;\n      });\n\n      if (add.opType === \"INSERT\") {\n        if (!address) {\n          console.log(add);\n          // dispatch(slice.actions.createAddress({ address }));\n        }\n      }\n    });\n  }\n}\n\nexport const addressApi = new AddressApi();\n"]},"metadata":{},"sourceType":"module"}