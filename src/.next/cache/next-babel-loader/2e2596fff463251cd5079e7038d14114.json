{"ast":null,"code":"import _regeneratorRuntime from \"/Users/pulkitshah/Desktop/truckarv2/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/pulkitshah/Desktop/truckarv2/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/pulkitshah/Desktop/truckarv2/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/pulkitshah/Desktop/truckarv2/renderer/contexts/amplify-context.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { createContext, useEffect, useReducer } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Amplify, { Auth } from \"aws-amplify\";\nimport awsconfig from \"../aws-exports\";\nimport { userApi } from \"../api/user-api\";\nAmplify.configure(awsconfig); // import { amplifyConfig } from \"../config\";\n// Amplify.configure(amplifyConfig);\n\nvar initialState = {\n  isAuthenticated: false,\n  isInitialized: false,\n  user: null\n};\nvar handlers = {\n  INITIALIZE: function INITIALIZE(state, action) {\n    var _action$payload = action.payload,\n        isAuthenticated = _action$payload.isAuthenticated,\n        user = _action$payload.user;\n    return _objectSpread(_objectSpread({}, state), {}, {\n      isAuthenticated: isAuthenticated,\n      isInitialized: true,\n      user: user\n    });\n  },\n  LOGIN: function LOGIN(state, action) {\n    var user = action.payload.user;\n    return _objectSpread(_objectSpread({}, state), {}, {\n      isAuthenticated: true,\n      user: user\n    });\n  },\n  LOGOUT: function LOGOUT(state) {\n    return _objectSpread(_objectSpread({}, state), {}, {\n      isAuthenticated: false // user: {},\n\n    });\n  },\n  REGISTER: function REGISTER(state) {\n    return _objectSpread({}, state);\n  },\n  VERIFY_CODE: function VERIFY_CODE(state) {\n    return _objectSpread({}, state);\n  },\n  RESEND_CODE: function RESEND_CODE(state) {\n    return _objectSpread({}, state);\n  },\n  PASSWORD_RECOVERY: function PASSWORD_RECOVERY(state) {\n    return _objectSpread({}, state);\n  },\n  PASSWORD_RESET: function PASSWORD_RESET(state) {\n    return _objectSpread({}, state);\n  },\n  UPDATE_USER: function UPDATE_USER(state) {\n    console.log(state);\n    return _objectSpread({}, state);\n  }\n};\n\nvar reducer = function reducer(state, action) {\n  return handlers[action.type] ? handlers[action.type](state, action) : state;\n};\n\nexport var AuthContext = /*#__PURE__*/createContext(_objectSpread(_objectSpread({}, initialState), {}, {\n  platform: \"Amplify\",\n  login: function login() {\n    return Promise.resolve();\n  },\n  logout: function logout() {\n    return Promise.resolve();\n  },\n  register: function register() {\n    return Promise.resolve();\n  },\n  verifyCode: function verifyCode() {\n    return Promise.resolve();\n  },\n  resendCode: function resendCode() {\n    return Promise.resolve();\n  },\n  passwordRecovery: function passwordRecovery() {\n    return Promise.resolve();\n  },\n  passwordReset: function passwordReset() {\n    return Promise.resolve();\n  },\n  updateUser: function updateUser() {\n    return Promise.resolve();\n  },\n  initialize: function initialize() {\n    return Promise.resolve();\n  }\n}));\nexport var AuthProvider = function AuthProvider(props) {\n  _s();\n\n  var children = props.children;\n\n  var _useReducer = useReducer(reducer, initialState),\n      state = _useReducer[0],\n      dispatch = _useReducer[1];\n\n  useEffect(function () {\n    initialize();\n  }, []);\n\n  var login = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(email, password) {\n      var cognitoUser, userDB, user;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return Auth.signIn(email, password);\n\n            case 2:\n              cognitoUser = _context.sent;\n              _context.next = 5;\n              return userApi.getUser(cognitoUser);\n\n            case 5:\n              userDB = _context.sent;\n              user = userDB.data.getUser;\n\n              if (!user.challengeName) {\n                _context.next = 10;\n                break;\n              }\n\n              console.error(\"Unable to login, because challenge \\\"\".concat(user.challengeName, \"\\\" is mandated and we did not handle this case.\"));\n              return _context.abrupt(\"return\");\n\n            case 10:\n              console.log(user);\n              dispatch({\n                type: \"LOGIN\",\n                payload: {\n                  user: {\n                    id: \"7d3f4331-f1ff-4a67-8f0d-1a6333d1d28b\",\n                    avatar: \"/static/mock-images/avatars/avatar-anika_visser.png\",\n                    email: user.email,\n                    name: user.name,\n                    phone_number: user.phone_number,\n                    onBoardingRequired: user.onBoardingRequired,\n                    plan: \"Premium\",\n                    _version: user._version\n                  }\n                }\n              });\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function login(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var logout = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return Auth.signOut();\n\n            case 2:\n              dispatch({\n                type: \"LOGOUT\"\n              });\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function logout() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var register = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(name, email, mobile, password) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return Auth.signUp({\n                username: email,\n                password: password,\n                attributes: {\n                  email: email,\n                  phone_number: \"+91\".concat(mobile),\n                  name: name\n                }\n              });\n\n            case 2:\n              dispatch({\n                type: \"REGISTER\"\n              });\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function register(_x3, _x4, _x5, _x6) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var verifyCode = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(username, code) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return Auth.confirmSignUp(username, code);\n\n            case 2:\n              dispatch({\n                type: \"VERIFY_CODE\"\n              });\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function verifyCode(_x7, _x8) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var resendCode = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(username) {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return Auth.resendSignUp(username);\n\n            case 2:\n              dispatch({\n                type: \"RESEND_CODE\"\n              });\n\n            case 3:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function resendCode(_x9) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var passwordRecovery = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(username) {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return Auth.forgotPassword(username);\n\n            case 2:\n              dispatch({\n                type: \"PASSWORD_RECOVERY\"\n              });\n\n            case 3:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function passwordRecovery(_x10) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var passwordReset = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(username, code, newPassword) {\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return Auth.forgotPasswordSubmit(username, code, newPassword);\n\n            case 2:\n              dispatch({\n                type: \"PASSWORD_RESET\"\n              });\n\n            case 3:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function passwordReset(_x11, _x12, _x13) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var initialize = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n      var cognitoUser, userDB, user;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.prev = 0;\n              _context8.next = 3;\n              return Auth.currentAuthenticatedUser();\n\n            case 3:\n              cognitoUser = _context8.sent;\n              _context8.next = 6;\n              return userApi.getUser(cognitoUser);\n\n            case 6:\n              userDB = _context8.sent;\n              user = userDB.data.getUser; // Here you should extract the complete user profile to make it\n              // available in your entire app.\n              // The auth state only provides basic information.\n\n              dispatch({\n                type: \"INITIALIZE\",\n                payload: {\n                  isAuthenticated: true,\n                  user: {\n                    id: user.id,\n                    avatar: \"/static/mock-images/avatars/avatar-anika_visser.png\",\n                    email: user.email,\n                    name: user.name,\n                    phone_number: user.phone_number,\n                    onBoardingRequired: user.onBoardingRequired,\n                    plan: \"Premium\",\n                    _version: user._version\n                  }\n                }\n              });\n              _context8.next = 15;\n              break;\n\n            case 11:\n              _context8.prev = 11;\n              _context8.t0 = _context8[\"catch\"](0);\n              console.log(_context8.t0);\n              dispatch({\n                type: \"INITIALIZE\",\n                payload: {\n                  isAuthenticated: false,\n                  user: null\n                }\n              });\n\n            case 15:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8, null, [[0, 11]]);\n    }));\n\n    return function initialize() {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var updateUser = /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(user) {\n      return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              dispatch({\n                type: \"UPDATE_USER\",\n                payload: {\n                  user: user\n                }\n              });\n\n            case 1:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }));\n\n    return function updateUser(_x14) {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: _objectSpread(_objectSpread({}, state), {}, {\n      platform: \"Amplify\",\n      login: login,\n      logout: logout,\n      register: register,\n      verifyCode: verifyCode,\n      resendCode: resendCode,\n      passwordRecovery: passwordRecovery,\n      passwordReset: passwordReset,\n      updateUser: updateUser,\n      initialize: initialize\n    }),\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 200,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(AuthProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n\n_c = AuthProvider;\nAuthProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport var AuthConsumer = AuthContext.Consumer;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/Users/pulkitshah/Desktop/truckarv2/renderer/contexts/amplify-context.js"],"names":["createContext","useEffect","useReducer","PropTypes","Amplify","Auth","awsconfig","userApi","configure","initialState","isAuthenticated","isInitialized","user","handlers","INITIALIZE","state","action","payload","LOGIN","LOGOUT","REGISTER","VERIFY_CODE","RESEND_CODE","PASSWORD_RECOVERY","PASSWORD_RESET","UPDATE_USER","console","log","reducer","type","AuthContext","platform","login","Promise","resolve","logout","register","verifyCode","resendCode","passwordRecovery","passwordReset","updateUser","initialize","AuthProvider","props","children","dispatch","email","password","signIn","cognitoUser","getUser","userDB","data","challengeName","error","id","avatar","name","phone_number","onBoardingRequired","plan","_version","signOut","mobile","signUp","username","attributes","code","confirmSignUp","resendSignUp","forgotPassword","newPassword","forgotPasswordSubmit","currentAuthenticatedUser","propTypes","node","isRequired","AuthConsumer","Consumer"],"mappings":"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","sourcesContent":["import { createContext, useEffect, useReducer } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Amplify, { Auth } from \"aws-amplify\";\nimport awsconfig from \"../aws-exports\";\nimport { userApi } from \"../api/user-api\";\nAmplify.configure(awsconfig);\n\n// import { amplifyConfig } from \"../config\";\n\n// Amplify.configure(amplifyConfig);\n\nconst initialState = {\n  isAuthenticated: false,\n  isInitialized: false,\n  user: null,\n};\n\nconst handlers = {\n  INITIALIZE: (state, action) => {\n    const { isAuthenticated, user } = action.payload;\n\n    return {\n      ...state,\n      isAuthenticated,\n      isInitialized: true,\n      user,\n    };\n  },\n  LOGIN: (state, action) => {\n    const { user } = action.payload;\n\n    return {\n      ...state,\n      isAuthenticated: true,\n      user,\n    };\n  },\n  LOGOUT: (state) => ({\n    ...state,\n    isAuthenticated: false,\n    // user: {},\n  }),\n  REGISTER: (state) => ({ ...state }),\n  VERIFY_CODE: (state) => ({ ...state }),\n  RESEND_CODE: (state) => ({ ...state }),\n  PASSWORD_RECOVERY: (state) => ({ ...state }),\n  PASSWORD_RESET: (state) => ({ ...state }),\n  UPDATE_USER: (state) => {\n    console.log(state);\n\n    return { ...state };\n  },\n};\n\nconst reducer = (state, action) =>\n  handlers[action.type] ? handlers[action.type](state, action) : state;\n\nexport const AuthContext = createContext({\n  ...initialState,\n  platform: \"Amplify\",\n  login: () => Promise.resolve(),\n  logout: () => Promise.resolve(),\n  register: () => Promise.resolve(),\n  verifyCode: () => Promise.resolve(),\n  resendCode: () => Promise.resolve(),\n  passwordRecovery: () => Promise.resolve(),\n  passwordReset: () => Promise.resolve(),\n  updateUser: () => Promise.resolve(),\n  initialize: () => Promise.resolve(),\n});\n\nexport const AuthProvider = (props) => {\n  const { children } = props;\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  useEffect(() => {\n    initialize();\n  }, []);\n\n  const login = async (email, password) => {\n    const cognitoUser = await Auth.signIn(email, password);\n    const userDB = await userApi.getUser(cognitoUser);\n    const user = userDB.data.getUser;\n    if (user.challengeName) {\n      console.error(\n        `Unable to login, because challenge \"${user.challengeName}\" is mandated and we did not handle this case.`\n      );\n      return;\n    }\n    console.log(user);\n    dispatch({\n      type: \"LOGIN\",\n      payload: {\n        user: {\n          id: \"7d3f4331-f1ff-4a67-8f0d-1a6333d1d28b\",\n          avatar: \"/static/mock-images/avatars/avatar-anika_visser.png\",\n          email: user.email,\n          name: user.name,\n          phone_number: user.phone_number,\n          onBoardingRequired: user.onBoardingRequired,\n          plan: \"Premium\",\n          _version: user._version,\n        },\n      },\n    });\n  };\n\n  const logout = async () => {\n    await Auth.signOut();\n    dispatch({\n      type: \"LOGOUT\",\n    });\n  };\n\n  const register = async (name, email, mobile, password) => {\n    await Auth.signUp({\n      username: email,\n      password,\n      attributes: { email, phone_number: `+91${mobile}`, name },\n    });\n    dispatch({\n      type: \"REGISTER\",\n    });\n  };\n\n  const verifyCode = async (username, code) => {\n    await Auth.confirmSignUp(username, code);\n    dispatch({\n      type: \"VERIFY_CODE\",\n    });\n  };\n\n  const resendCode = async (username) => {\n    await Auth.resendSignUp(username);\n    dispatch({\n      type: \"RESEND_CODE\",\n    });\n  };\n\n  const passwordRecovery = async (username) => {\n    await Auth.forgotPassword(username);\n    dispatch({\n      type: \"PASSWORD_RECOVERY\",\n    });\n  };\n\n  const passwordReset = async (username, code, newPassword) => {\n    await Auth.forgotPasswordSubmit(username, code, newPassword);\n    dispatch({\n      type: \"PASSWORD_RESET\",\n    });\n  };\n\n  const initialize = async () => {\n    try {\n      const cognitoUser = await Auth.currentAuthenticatedUser();\n      const userDB = await userApi.getUser(cognitoUser);\n      const user = userDB.data.getUser;\n      // Here you should extract the complete user profile to make it\n      // available in your entire app.\n      // The auth state only provides basic information.\n      dispatch({\n        type: \"INITIALIZE\",\n        payload: {\n          isAuthenticated: true,\n          user: {\n            id: user.id,\n            avatar: \"/static/mock-images/avatars/avatar-anika_visser.png\",\n            email: user.email,\n            name: user.name,\n            phone_number: user.phone_number,\n            onBoardingRequired: user.onBoardingRequired,\n            plan: \"Premium\",\n            _version: user._version,\n          },\n        },\n      });\n    } catch (error) {\n      console.log(error);\n      dispatch({\n        type: \"INITIALIZE\",\n        payload: {\n          isAuthenticated: false,\n          user: null,\n        },\n      });\n    }\n  };\n\n  const updateUser = async (user) => {\n    dispatch({\n      type: \"UPDATE_USER\",\n      payload: {\n        user,\n      },\n    });\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        ...state,\n        platform: \"Amplify\",\n        login,\n        logout,\n        register,\n        verifyCode,\n        resendCode,\n        passwordRecovery,\n        passwordReset,\n        updateUser,\n        initialize,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nAuthProvider.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nexport const AuthConsumer = AuthContext.Consumer;\n"]},"metadata":{},"sourceType":"module"}