{"ast":null,"code":"import { API } from \"aws-amplify\";\nimport { ordersByUser } from \"../graphql/queries\";\nconst now = new Date();\n\nclass OrderApi {\n  async getOrdersByUser(user) {\n    const ordersDB = await API.graphql({\n      query: ordersByUser,\n      variables: {\n        user: user.id.toString()\n      }\n    });\n    return ordersDB;\n  }\n\n  async createOrder(newOrder, dispatch) {\n    const createdAt = moment().toISOString();\n    let newOrg = newOrder;\n    newOrg.createdAt = createdAt; //////////////////////// GraphQL API ////////////////////////\n\n    const response = await API.graphql({\n      query: createOrder,\n      variables: {\n        input: newOrg\n      },\n      authMode: \"AMAZON_COGNITO_USER_POOLS\"\n    });\n    const order = response.data.createOrder; //////////////////////// GraphQL API ////////////////////////\n    //////////////////////// DataStore API ////////////////////////\n    // const order = await DataStore.save(new Order(newOrg));\n    //////////////////////// DataStore API ////////////////////////\n\n    console.log(order); // Dispatch - Reducer\n\n    dispatch(slice.actions.createOrder({\n      order\n    }));\n    return order;\n  }\n\n  async validateDuplicateOrderNo(orderNo, user) {\n    const response = await API.graphql({\n      query: ordersByUser,\n      variables: {\n        user: user.id.toString()\n      }\n    });\n    const orders = response.data.ordersByUser.items;\n    const order = orders.find(order => {\n      return order.orderNo === orderNo;\n    });\n    return Boolean(!order);\n  }\n\n}\n\nexport const orderApi = new OrderApi();","map":{"version":3,"sources":["/Users/pulkitshah/Desktop/truckarv2/renderer/api/order-api.js"],"names":["API","ordersByUser","now","Date","OrderApi","getOrdersByUser","user","ordersDB","graphql","query","variables","id","toString","createOrder","newOrder","dispatch","createdAt","moment","toISOString","newOrg","response","input","authMode","order","data","console","log","slice","actions","validateDuplicateOrderNo","orderNo","orders","items","find","Boolean","orderApi"],"mappings":"AAAA,SAASA,GAAT,QAAoB,aAApB;AACA,SAASC,YAAT,QAA6B,oBAA7B;AAEA,MAAMC,GAAG,GAAG,IAAIC,IAAJ,EAAZ;;AAEA,MAAMC,QAAN,CAAe;AACb,QAAMC,eAAN,CAAsBC,IAAtB,EAA4B;AAC1B,UAAMC,QAAQ,GAAG,MAAMP,GAAG,CAACQ,OAAJ,CAAY;AACjCC,MAAAA,KAAK,EAAER,YAD0B;AAEjCS,MAAAA,SAAS,EAAE;AAAEJ,QAAAA,IAAI,EAAEA,IAAI,CAACK,EAAL,CAAQC,QAAR;AAAR;AAFsB,KAAZ,CAAvB;AAIA,WAAOL,QAAP;AACD;;AAED,QAAMM,WAAN,CAAkBC,QAAlB,EAA4BC,QAA5B,EAAsC;AACpC,UAAMC,SAAS,GAAGC,MAAM,GAAGC,WAAT,EAAlB;AACA,QAAIC,MAAM,GAAGL,QAAb;AACAK,IAAAA,MAAM,CAACH,SAAP,GAAmBA,SAAnB,CAHoC,CAKpC;;AAEA,UAAMI,QAAQ,GAAG,MAAMpB,GAAG,CAACQ,OAAJ,CAAY;AACjCC,MAAAA,KAAK,EAAEI,WAD0B;AAEjCH,MAAAA,SAAS,EAAE;AAAEW,QAAAA,KAAK,EAAEF;AAAT,OAFsB;AAGjCG,MAAAA,QAAQ,EAAE;AAHuB,KAAZ,CAAvB;AAMA,UAAMC,KAAK,GAAGH,QAAQ,CAACI,IAAT,CAAcX,WAA5B,CAboC,CAepC;AAEA;AAEA;AAEA;;AAEAY,IAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ,EAvBoC,CAyBpC;;AAEAR,IAAAA,QAAQ,CAACY,KAAK,CAACC,OAAN,CAAcf,WAAd,CAA0B;AAAEU,MAAAA;AAAF,KAA1B,CAAD,CAAR;AAEA,WAAOA,KAAP;AACD;;AAED,QAAMM,wBAAN,CAA+BC,OAA/B,EAAwCxB,IAAxC,EAA8C;AAC5C,UAAMc,QAAQ,GAAG,MAAMpB,GAAG,CAACQ,OAAJ,CAAY;AACjCC,MAAAA,KAAK,EAAER,YAD0B;AAEjCS,MAAAA,SAAS,EAAE;AAAEJ,QAAAA,IAAI,EAAEA,IAAI,CAACK,EAAL,CAAQC,QAAR;AAAR;AAFsB,KAAZ,CAAvB;AAIA,UAAMmB,MAAM,GAAGX,QAAQ,CAACI,IAAT,CAAcvB,YAAd,CAA2B+B,KAA1C;AACA,UAAMT,KAAK,GAAGQ,MAAM,CAACE,IAAP,CAAaV,KAAD,IAAW;AACnC,aAAOA,KAAK,CAACO,OAAN,KAAkBA,OAAzB;AACD,KAFa,CAAd;AAGA,WAAOI,OAAO,CAAC,CAACX,KAAF,CAAd;AACD;;AAnDY;;AAsDf,OAAO,MAAMY,QAAQ,GAAG,IAAI/B,QAAJ,EAAjB","sourcesContent":["import { API } from \"aws-amplify\";\nimport { ordersByUser } from \"../graphql/queries\";\n\nconst now = new Date();\n\nclass OrderApi {\n  async getOrdersByUser(user) {\n    const ordersDB = await API.graphql({\n      query: ordersByUser,\n      variables: { user: user.id.toString() },\n    });\n    return ordersDB;\n  }\n\n  async createOrder(newOrder, dispatch) {\n    const createdAt = moment().toISOString();\n    let newOrg = newOrder;\n    newOrg.createdAt = createdAt;\n\n    //////////////////////// GraphQL API ////////////////////////\n\n    const response = await API.graphql({\n      query: createOrder,\n      variables: { input: newOrg },\n      authMode: \"AMAZON_COGNITO_USER_POOLS\",\n    });\n\n    const order = response.data.createOrder;\n\n    //////////////////////// GraphQL API ////////////////////////\n\n    //////////////////////// DataStore API ////////////////////////\n\n    // const order = await DataStore.save(new Order(newOrg));\n\n    //////////////////////// DataStore API ////////////////////////\n\n    console.log(order);\n\n    // Dispatch - Reducer\n\n    dispatch(slice.actions.createOrder({ order }));\n\n    return order;\n  }\n\n  async validateDuplicateOrderNo(orderNo, user) {\n    const response = await API.graphql({\n      query: ordersByUser,\n      variables: { user: user.id.toString() },\n    });\n    const orders = response.data.ordersByUser.items;\n    const order = orders.find((order) => {\n      return order.orderNo === orderNo;\n    });\n    return Boolean(!order);\n  }\n}\n\nexport const orderApi = new OrderApi();\n"]},"metadata":{},"sourceType":"module"}